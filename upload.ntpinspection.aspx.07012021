<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<!- ******************************************************************* ->
<!- * File: upload.reports.aspx                                       * ->
<!- *                                                                 * ->
<!- * Purpose: Uploads condition reports                              * ->
<!- *                                                                 * ->
<!- * Written by: m.samuel 7.9.2006                                   * ->
<!- *                                                                 * ->
<!- ******************************************************************* -> 
<%@ page language="vb" debug="true" CompilerOptions='/R:"c:\program files (x86)\ibm\client access\IBM.Data.DB2.iSeries.dll"'%>

<%@ Import NameSpace="IBM.Data.DB2.iseries" %>
<%@ Import NameSpace="System.Data" %>
<%@ Import NameSpace="System.IO" %>
<%@ Import NameSpace="System.Runtime.InteropServices" %>
<!- ******************************************************************* ->
<!- *                      Define Script                              * ->
<!- ******************************************************************* ->  
<Script Runat="Server">

    Public strVin As String

    ' ******************************************************************* ->
    ' *                      Page Load Subroutine                       * ->
    ' ******************************************************************* -> 
    Sub Page_Load()

    End Sub
    ' ******************************************************************* ->
    ' *                      Upload Images Buttone Clicked              * ->
    ' ******************************************************************* -> 
    Sub Button_Click(s As Object, e As EventArgs)

        lblMessage.Text = ""

        If txtStock.Text = "" Then
            lblMessage.Text = "Please enter an Stock Number Number!"
        Else
            If inpFileUp.HasFile = False Then
                lblMessage.Text = "Please Select a File to Upload!"
            Else
                ' Create Folder
                System.IO.Directory.CreateDirectory("\\ats58\NTPInspections\" + txtStock.Text.Trim())

                If inpFileUp.PostedFile.ContentLength() <> 0 Then
                    inpFileUp.SaveAs("\\ats58\NTPInspections\" + txtStock.Text.Trim() + "\NtpInspectionForm.pdf")
                End If

                lblMessage.Text = "NTP Inspection Report Uploaded!"
            End If
        End If
    End Sub

</script>
<!- ******************************************************************* ->
<!- *                       End Script                                * ->
<!- ******************************************************************* ->  
<html>
<title>Image Upload</title> 
<style type="text/css">
<!--
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
}
.style1 {
	font-family: Arial, Helvetica, sans-serif;
	font-weight: bold;
}
.style2 {	font-family: Arial, Helvetica, sans-serif;
	font-size: small;
	font-style: italic;
	color: #0000FF;
}
.style3 {
	font-family: Arial, Helvetica, sans-serif;
	color: #0000FF;
}
-->
</style>    

<body>

<form runat="Server">

<center>
<table>

 <tr>
    <td>
      <img src="../images/arrowlogoweb.gif">
     
  </tr>

    <tr>
        <td align="center">
           <b>Upload NTP Inspection Form</b>
      </td>       
    </tr>

    <tr>
        <td>&nbsp</td>
    </tr>

<tr> 
    <td>       

    <b>Enter Stock Number:</b>
    <asp:TextBox id="txtStock" runat="server"/>
	
    <asp:CompareValidator
    ControlToValidate="txtStock"
    Display="Dynamic"
    Operator="DataTypeCheck"
    type="Integer"
    text="Must be Numeric!"
    runat="server"/>
    <asp:RegularExpressionValidator
    controltovalidate="txtStock"
    display="Dynamic"
    text="Up to 7 digits allowed"
    validationexpression="\S{0,7}"
    runat="server"/>   
        
        </td>
    </tr>

 <tr>
      <td>&nbsp</td>
  </tr>
    
<tr>
    <td>
    <asp:FileUpload id="inpFileUp" runat="server" ForeColor="Red" />   
    </td>
</tr> 	
    
 <tr>
        <td>&nbsp</td>
 </tr>    	

<tr>
    <td>          
    <asp:Button
    Text="Upload NTP Inspection File"
    OnClick="Button_Click"
    runat="server" />  
        
    </td>
</tr> 

 <tr>
        <td>&nbsp</td>
 </tr>  

<tr>
    <td>
    <asp:label id="lblMessage" font-bold="true"  foreColor="#FF0000" runat="server"/>	
    </td>
</tr>
</table>	
</center>

</form>		

</body>
</html>
